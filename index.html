<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rahul Jangid</title>
    <link rel="icon" href="/Pages/favicon.png" />
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Merriweather&family=Roboto&family=Open+Sans&family=Lora&family=Montserrat&family=Poppins&family=Raleway&family=Oswald&family=Source+Serif+4&family=Fira+Code&family=Pacifico&family=Great+Vibes&family=Inter&display=swap" rel="stylesheet">
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #000;
        font-family: 'Source Serif 4', serif;
        position: relative;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        /* smooth native scroll on iOS */
      }

      body::before {
        content: "“";
        position: absolute;
        top: 1.5rem;
        left: 1.5rem;
        font-size: clamp(8rem, 24vw, 20rem);
        line-height: 1;
        color: #ff0000;
        font-family: "Georgia", "Times New Roman", serif;
        font-weight: 700;
        opacity: 0.9;
        pointer-events: none;
      }

      body::after {
        content: "";
        position: fixed;
        inset: 0;
        z-index: -1;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        filter: brightness(0.45);
        transition: background-image 0.6s ease;
        background-image:
          linear-gradient(rgba(0, 0, 0, 0.55), rgba(0, 0, 0, 0.55)),
          var(--bg-image);
      }

      .quote-box {
        max-width: min(800px, 90vw);
        padding: 2rem 1.5rem;
        text-align: center;
        position: relative;
        z-index: 1;
      }

      .quote {
        color: #ffffff;
        font-size: clamp(1.2rem, 3.5vw, 2.5rem);
        line-height: 1.45;
        margin-bottom: 1rem;
        font-weight: 600;
        max-width: 100%;
        overflow-wrap: normal;
        word-wrap: normal;
        hyphens: none;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      @media (max-width: 640px) {
        .quote {
          -webkit-line-clamp: 9;
        }
      }

      .author {
        color: #9ca3af;
        font-size: 0.8rem;
        letter-spacing: 0.05em;
        font-style: italic;
      }

      footer {
        position: absolute;
        bottom: 1.5rem;
        right: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.6rem;
        color: #9ca3af;
        font-size: 0.7rem;
      }

      .logo {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: url('https://rahuljangid001122.github.io/Pages/favicon.png') center / cover no-repeat;
        cursor: pointer;
      }

      #quoteInput {
        maxlength: 200;
      }

      #authorInput {
        maxlength: 50;
      }

      .quote-list {
        max-height: 300px;
        overflow-y: auto;
        margin-top: 0.5rem;
        padding-top: 0.5rem;
        display: none;
        border-top: none;
      }

      .author-header {
        font-weight: 600;
        margin-top: 0.5rem;
        cursor: pointer;
        user-select: none;
        border-bottom: 1px solid #ccc;
        padding-bottom: 0.2rem;
      }

      .author-quotes {
        display: none;
        margin-left: 0.5rem;
        margin-top: 0.25rem;
        border-left: 2px solid #ccc;
        padding-left: 0.5rem;
      }

      .quote-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.25rem;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.2rem;
      }

      .quote-item span {
        flex: 1;
        margin-right: 0.5rem;
      }

      .delete-btn {
        background: none;
        color: #c00;
        border: none;
        font-weight: bold;
        font-size: 1rem;
        cursor: pointer;
      }

      #saveBtn,
      #moreBtn {
        background: #444;
        color: #fff;
        border: none;
        padding: 0.35rem 0.75rem;
        font-size: 0.85rem;
        cursor: pointer;
        display: none;
      }

      #closeModal {
        position: relative;
        display: none;
        margin-top: 0.5rem;
        width: 100%;
        padding: 0.35rem;
        font-size: 0.85rem;
        background: #ccc;
        border: none;
        cursor: pointer;
        text-align: center;
      }

      .company-name {
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="quote-box">
      <div class="quote">Rahul Jangid</div>
      <div class="author"></div>
    </div>
    <footer>
      <div class="company-name" id="aboutBtn">Rahul Jangid</div>
      <div class="logo"></div>
    </footer>
    <div id="modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); align-items:center; justify-content:center; z-index:10;">
      <div style="background:#f9f9f9; padding:1rem 1.25rem 1.25rem; border-radius:6px; width:90%; max-width:380px; color:#111; position:relative; font-family: Arial, Helvetica, sans-serif;">
        <h3 id="modalTitle" style="margin:0 0 0.75rem 0; font-size:1rem; font-weight:600; display:none;">Add Quote</h3>
        <input type="password" id="accessCode" placeholder="Enter access code" style="width:100%; margin-bottom:0.5rem; padding:0.45rem; background:#fff; color:#111; border:1px solid #ccc; font-size:0.9rem;" />
        <input id="quoteInput" placeholder="Quote" style="width:100%; margin-bottom:0.5rem; padding:0.45rem; background:#fff; color:#111; border:1px solid #ccc; font-size:0.9rem; display:none;" maxlength="200" />
        <input id="authorInput" placeholder="Author" style="width:100%; margin-bottom:0.5rem; padding:0.45rem; background:#fff; color:#111; border:1px solid #ccc; font-size:0.9rem; display:none;" maxlength="50" />
        <div style="display:flex; justify-content:space-between; margin-bottom:0.5rem;">
          <button id="saveBtn">Save</button>
          <button id="moreBtn">More</button>
        </div>
        <button id="closeModal">Close</button>
        <div class="quote-list" id="quoteList"></div>
      </div>
    </div>
    <div id="aboutModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; z-index:9;">
      <div style="
  background:#fff;
  color:#111;
  width:90%;
  max-width:420px;
  max-height:80vh;
  border-radius:6px;
  display:flex;
  flex-direction:column;
  font-family: Arial, Helvetica, sans-serif;
">
        <!-- SCROLLABLE CONTENT -->
        <div style="
    padding:1.25rem;
    overflow-y:auto;
    flex:1;
  ">
          <h3 style="margin-top:0; font-size:1rem;">Thought</h3>
          <p style="font-size:0.9rem; line-height:1.4;">What is done is done. What is gone is gone. There's no time to regret. Move on ! You can wait but time doesn't wait for anyone. You can only increase your productivity to save time.</p>
          <h3 style="font-size:1rem; margin-top:1rem;">Biography</h3>
          <p style="font-size:0.9rem; line-height:1.4;">In Progress...</p>
        </div>
        <!-- STICKY FOOTER -->
        <button id="closeAbout" style="
    border:none;
    border-top:1px solid #ddd;
    padding:0.6rem;
    background:#eee;
    cursor:pointer;
    border-bottom-left-radius:6px;
  border-bottom-right-radius:6px;
  "> Close </button>
      </div>
    </div>
    <script type="module">
      import {
        initializeApp
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import {
        getDatabase,
        ref,
        push,
        get,
        child,
        remove
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
      const firebaseConfig = {
        apiKey: "AIzaSyA5iLF-J-WvNaYm63r8rDZU8_rtZsgwYng",
        authDomain: "my-todo-2e111.firebaseapp.com",
        databaseURL: "https://my-todo-2e111-default-rtdb.firebaseio.com",
        projectId: "my-todo-2e111",
        storageBucket: "my-todo-2e111.appspot.com",
        messagingSenderId: "765517702108",
        appId: "1:7655176208:web:2dfe7d6205040cfd2ea519"
      };
      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      async function sha256(message) {
        const msgBuffer = new TextEncoder().encode(message);
        const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
      }
      window.addEventListener('DOMContentLoaded', () => {
        let quotesArray = [];
        let currentIndex = 0;
        const logo = document.querySelector('.logo');
        const modal = document.getElementById('modal');
        const saveBtn = document.getElementById('saveBtn');
        const moreBtn = document.getElementById('moreBtn');
        const quoteEl = document.querySelector('.quote');
        const authorEl = document.querySelector('.author');
        const closeBtn = document.getElementById('closeModal');
        const quoteList = document.getElementById('quoteList');
        const accessCode = document.getElementById('accessCode');
        const quoteInput = document.getElementById('quoteInput');
        const authorInput = document.getElementById('authorInput');
        const modalTitle = document.getElementById('modalTitle');
        const correctHash = '44544e0d6770664c4c13ae2ed2438373c2014f112a6f5fcd7c241ba79222bc16';
        const aboutBtn = document.getElementById('aboutBtn');
        const aboutModal = document.getElementById('aboutModal');
        const closeAbout = document.getElementById('closeAbout');
        let startX = 0;
        let endX = 0;
        document.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX;
        }, {
          passive: true
        });
        document.addEventListener('touchend', (e) => {
          endX = e.changedTouches[0].clientX;
          const diff = startX - endX;
          if (Math.abs(diff) > 60) {
            if (diff > 0) {
              nextQuote(); // swipe left
            } else {
              prevQuote(); // swipe right
            }
          }
        });
        let lastBgIndex = null;
        const TOTAL_BACKGROUNDS = 54; // ← change only this number later
        function setRandomBackground() {
          let index;
          do {
            index = Math.floor(Math.random() * TOTAL_BACKGROUNDS) + 1;
          } while (index === lastBgIndex);
          lastBgIndex = index;
          const fileName = `/Pages/images/bg_${String(index).padStart(3, "0")}.jpg`;
          document.body.style.setProperty("--bg-image", `url('${fileName}')`);
        }
        setRandomBackground();
        aboutBtn.addEventListener('click', () => {
          aboutModal.style.display = 'flex';
        });
        closeAbout.addEventListener('click', () => {
          aboutModal.style.display = 'none';
        });
        logo.addEventListener('click', () => {
          modal.style.display = 'flex';
          quoteList.style.display = 'none';
          quoteList.innerHTML = '';
          accessCode.style.display = 'block';
          quoteInput.style.display = 'none';
          authorInput.style.display = 'none';
          saveBtn.style.display = 'none';
          moreBtn.style.display = 'none';
          modalTitle.style.display = 'none';
          closeBtn.style.display = 'block';
          accessCode.value = '';
        });
        closeBtn.addEventListener('click', () => {
          modal.style.display = 'none';
        });
        accessCode.addEventListener('keypress', async (e) => {
          if (e.key === 'Enter') {
            const hash = await sha256(accessCode.value.trim());
            if (hash === correctHash) {
              quoteInput.style.display = 'block';
              authorInput.style.display = 'block';
              saveBtn.style.display = 'block';
              moreBtn.style.display = 'block';
              modalTitle.style.display = 'block';
              accessCode.style.display = 'none';
            } else {
              alert('Incorrect access code');
            }
          }
        });
        saveBtn.addEventListener('click', async () => {
          const q = quoteInput.value.trim();
          const a = authorInput.value.trim();
          if (!q || !a) return;
          await push(ref(db, 'quotes'), {
            quote: q,
            author: a
          });
          quoteInput.value = '';
          authorInput.value = '';
        });
        moreBtn.addEventListener('click', async () => {
          quoteList.style.display = 'block';
          quoteList.innerHTML = 'Loading...';
          const snapshot = await get(child(ref(db), 'quotes'));
          if (!snapshot.exists()) {
            quoteList.innerHTML = 'No quotes found';
            return;
          }
          const data = snapshot.val();
          const grouped = {};
          Object.entries(data).forEach(([key, value]) => {
            const cleanAuthor = value.author.replace(/\s+/g, ' ').trim().toLowerCase();
            if (!grouped[cleanAuthor]) grouped[cleanAuthor] = [];
            grouped[cleanAuthor].push({
              id: key,
              quote: value.quote,
              originalAuthor: value.author
            });
          });
          const sortedAuthors = Object.keys(grouped).sort((a, b) => a.localeCompare(b));
          quoteList.innerHTML = '';
          sortedAuthors.forEach(author => {
            const quotes = grouped[author];
            const authorHeader = document.createElement('div');
            authorHeader.className = 'author-header';
            authorHeader.textContent = quotes[0].originalAuthor.replace(/\s+/g, ' ').trim();
            quoteList.appendChild(authorHeader);
            const quoteContainer = document.createElement('div');
            quoteContainer.className = 'author-quotes';
            quotes.forEach(qObj => {
              const div = document.createElement('div');
              div.className = 'quote-item';
              const span = document.createElement('span');
              span.textContent = qObj.quote;
              const delBtn = document.createElement('button');
              delBtn.innerHTML = '&times;';
              delBtn.className = 'delete-btn';
              delBtn.addEventListener('click', async () => {
                if (confirm('Are you sure you want to delete this quote?')) {
                  await remove(ref(db, `quotes/${qObj.id}`));
                  div.remove();
                }
              });
              div.appendChild(span);
              div.appendChild(delBtn);
              quoteContainer.appendChild(div);
            });
            authorHeader.addEventListener('click', () => {
              quoteContainer.style.display = quoteContainer.style.display === 'none' ? 'block' : 'none';
            });
            quoteList.appendChild(quoteContainer);
          });
        });
        async function loadRandomQuote() {
          quoteEl.innerHTML = "Rahul Jangid<br/>Welcomes You...";
          authorEl.textContent = '';
          const snapshot = await get(child(ref(db), 'quotes'));
          if (!snapshot.exists()) return;
          quotesArray = Object.values(snapshot.val());
          // shuffle array (Fisher–Yates)
          for (let i = quotesArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [quotesArray[i], quotesArray[j]] = [quotesArray[j], quotesArray[i]];
          }
          currentIndex = 0;
          showQuote();
        }

        function showQuote() {
          if (!quotesArray.length) return;
          const q = quotesArray[currentIndex];
          quoteEl.textContent = q.quote;
          authorEl.textContent = q.author;
        }

        function nextQuote() {
          currentIndex = (currentIndex + 1) % quotesArray.length;
          showQuote();
          setRandomBackground();
        }

        function prevQuote() {
          currentIndex = (currentIndex - 1 + quotesArray.length) % quotesArray.length;
          showQuote();
          setRandomBackground();
        }
        loadRandomQuote();
      });
    </script>
  </body>
</html>
