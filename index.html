<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Exo+2&display=swap" rel="stylesheet">
<title>Rahul Jangid</title>
<link rel="icon" type="image/png" href="/Pages/favicon.png">
  <!-- Patrick Hand font -->
  <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

  <style>
    /* page styles */
    html,body{height:100%}
    body{
      margin:0;
      min-height:100vh;
      background:#000;
      color:#fff;
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",Segoe UI,Roboto,Arial,sans-serif;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:16px;
    }
    .wrap{ text-align:center; margin-bottom:30px; }
    #clock{ font-size:60px; font-weight:900; }
    #date{ font-size:18px; margin-top:8px; opacity:0.7; }
    #countdown{ font-size:20px; margin-top:6px; opacity:0.8; }
    #percentage{ font-size:10px; margin-top:4px; opacity:0.4; }

    /* Common container style */
    .container{
      width:95%;
      max-width:560px;
      box-sizing: border-box;
      margin-bottom:12px;
    }

    /* To-Do Styles */
    .todo-container{
      background:#1c1c1e;
      padding:16px;
      border-radius:12px;
      font-size:14px;
      max-height:350px;
      display:flex;
      flex-direction:column;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    }
    .todo-container h2{ font-size:20px; margin-bottom:12px; font-weight:600; }
    .todo-form{ display:flex; flex-wrap:wrap; gap:6px; margin-bottom:10px; }
    .todo-form input{ padding:8px 10px; border-radius:8px; border:none; font-size:14px; background:#2c2c2e; color:#fff; box-sizing: border-box; }
    .todo-form input[type='date']{ width:140px; }
    .todo-form input[type='text']{ flex:1; }
    .todo-form input::-webkit-contacts-auto-fill-button, .todo-form input::-webkit-credentials-auto-fill-button { display: none !important; -webkit-appearance: none; }

    .todo-list{ margin-top:10px; overflow-y:auto; flex:1; font-size:14px; }
    .todo-item{ display:flex; align-items:center; justify-content: space-between; padding:10px; border-bottom:1px solid #333; border-radius:8px; transition: background 0.2s; }
    .todo-item:hover{ background:rgba(255,255,255,0.05); }
    .todo-left{ display:flex; align-items:center; flex:1; }
    .todo-checkbox{ width:18px; height:18px; margin-right:10px; cursor:pointer; flex-shrink:0; }
    .todo-text{
      flex:1;
      cursor:pointer;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .todo-text.expanded{ display:block; -webkit-line-clamp: unset; }
    .completed{ text-decoration: line-through; opacity:0.6; }
    .delete-btn{ background:none; border:none; color:#ff3b30; cursor:pointer; font-size:16px; transition: color 0.2s; }
    .delete-btn:hover{ color:#ff0000; }
    #loading-text{ text-align:center; margin-top:10px; opacity:0.6; font-size:12px; display:none; }

    /* Daily Journal Styles */
    .journal-container{
      background:#1c1c1e;
      padding:16px;
      border-radius:12px;
      font-size:14px;
      display:flex;
      flex-direction:column;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      font-family: 'Patrick Hand', cursive;
    }
    .journal-container h2{ font-size:20px; margin-bottom:12px; font-weight:600; }
    .journal-form{ display:flex; gap:6px; margin-bottom:10px; }
    .journal-form input[type='date']{
      width:140px; padding:7px; border-radius:8px; border:none; background:#2c2c2e; color:#fff; box-sizing: border-box;
      font-family: 'Patrick Hand', cursive;
    }
    .journal-textarea{
      width:100%;
      background:#2c2c2e;
      color:#fff;
      border:none;
      border-radius:10px;
      padding:12px;
      resize:none;
      font-size:16px;
      min-height:410px;
      font-family: 'Patrick Hand', cursive;
      box-sizing: border-box;
    }

    /* LOCK OVERLAY */
    .lock-overlay{
      position:fixed;
      inset:0;
      background:linear-gradient(180deg, rgba(0,0,0,1), rgba(0,0,0,1));
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9999;
      padding:20px;
    }
    .lock-box{
      width:100%;
      max-width:420px;
      background:#0b0b0b;
      border-radius:12px;
      padding:20px;
      box-shadow:0 10px 40px rgba(0,0,0,0.8);
      border:1px solid rgba(255,255,255,0.04);
      text-align:center;
    }
    .lock-box h1{ margin:0 0 12px 0; font-size:20px; font-weight:700; }
    .lock-box p{ margin:0 0 14px 0; opacity:0.7; font-size:13px; }
    .lock-input{
      width:100%;
      padding:12px;
      border-radius:8px;
      border:none;
      background:#121212;
      color:#fff;
      font-size:16px;
      box-sizing:border-box;
      outline:none;
      margin-bottom:10px;
    }
    .lock-btn{
      width:100%;
      padding:10px;
      border-radius:8px;
      border:none;
      background:#0a84ff;
      color:#fff;
      font-weight:600;
      cursor:pointer;
      font-size:16px;
    }
    .lock-error{ color:#ff6b6b; font-size:13px; margin-top:10px; display:none; }

    /* small animation for wrong password */
    .shake{ animation:shake .35s; }
    @keyframes shake {
      0% { transform:translateX(0) }
      20% { transform:translateX(-8px) }
      40% { transform:translateX(8px) }
      60% { transform:translateX(-6px) }
      80% { transform:translateX(6px) }
      100% { transform:translateX(0) }
    }
  </style>
</head>
<body>
  <!-- LOCK OVERLAY: shown until correct password entered -->
  <div id="lockOverlay" class="lock-overlay" aria-hidden="false">
    <div class="lock-box" id="lockBox" role="dialog" aria-modal="true" aria-labelledby="lockTitle">
      <h1 id="lockTitle">Rahul Jangid</h1>
      <p>Enter the password to unlock this page.</p>
      <input id="lockInput" class="lock-input" type="password" placeholder="Password" autocomplete="current-password" />
      <button id="lockBtn" class="lock-btn">Unlock</button>
      <div id="lockError" class="lock-error">Incorrect password</div>
    </div>
  </div>

  <!-- main content (kept exactly as before) -->
  <div class="wrap">
    <div id="clock">--:--:--</div>
    <div id="date">---</div>
    <div id="countdown">--:--:--:--</div>
    <div id="percentage">Year: --% | Month: --%</div>
  </div>

  <div class="container todo-container">
    <h2>To-Do List</h2>
    <form class="todo-form" onsubmit="return addTodo()">
      <input type="date" id="todo-date" />
      <input type="text" id="todo-text" placeholder="Add New Task" autocomplete="off" />
    </form>
    <div id="loading-text">Loading...</div>
    <div class="todo-list" id="todo-list"></div>
  </div>

  <div class="container journal-container">
    <h2>Daily Journal</h2>
    <form class="journal-form">
      <input type="date" id="journal-date" />
    </form>
    <textarea class="journal-textarea" id="journal-text" placeholder="Write your journal entry here..."></textarea>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
    const PASSWORD_HASH = "44544e0d6770664c4c13ae2ed2438373c2014f112a6f5fcd7c241ba79222bc16";

    const lockOverlay = document.getElementById('lockOverlay');
    const lockInput = document.getElementById('lockInput');
    const lockBtn = document.getElementById('lockBtn');
    const lockError = document.getElementById('lockError');
    const lockBox = document.getElementById('lockBox');

    // helper: compute SHA-256 hex string of input text
    async function sha256Hex(text){
      const enc = new TextEncoder();
      const data = enc.encode(text);
      const hash = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hash));
      return hashArray.map(b => b.toString(16).padStart(2,'0')).join('');
    }

    async function tryUnlock(){
      lockError.style.display = 'none';
      lockBox.classList.remove('shake');
      const value = lockInput.value || '';
      try {
        const h = await sha256Hex(value);
        if(h === PASSWORD_HASH){
          // unlocked
          lockOverlay.style.display = 'none';
          lockOverlay.setAttribute('aria-hidden','true');
          // focus first interactive element for accessibility
          setTimeout(()=>{ document.getElementById('todo-text')?.focus(); }, 50);
          return;
        } else {
          lockError.style.display = 'block';
          lockBox.classList.add('shake');
        }
      } catch(e){
        console.error('Error computing password hash', e);
        lockError.textContent = 'Error';
        lockError.style.display = 'block';
      }
    }

    lockBtn.addEventListener('click', tryUnlock);
    lockInput.addEventListener('keypress', function(e){
      if(e.key === 'Enter') { e.preventDefault(); tryUnlock(); }
    });

    // Accessibility: focus input on load
    lockInput.focus();

    // ---------- END PASSWORD PROTECTION ----------
  </script>

  <script>
    // ---------- MAIN APP (keeps original logic) ----------
    const firebaseConfig = {
      apiKey: "AIzaSyA5iLF-J-WvNaYm63r8rDZU8_rtZsgwYng",
      authDomain: "my-todo-2e111.firebaseapp.com",
      databaseURL: "https://my-todo-2e111-default-rtdb.firebaseio.com",
      projectId: "my-todo-2e111",
      storageBucket: "my-todo-2e111.appspot.com",
      messagingSenderId: "765517702108",
      appId: "1:765517702108:web:2dfe7d6205040cfd2ea519"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Clock & Countdown logic
    const clockEl = document.getElementById('clock');
    const dateEl = document.getElementById('date');
    const countdownEl = document.getElementById('countdown');
    const percentageEl = document.getElementById('percentage');

    function pad(n){ return n<10?'0'+n:n; }
    function getOrdinal(n){ if(n>3&&n<21) return 'th'; switch(n%10){case 1:return 'st';case 2:return 'nd';case 3:return 'rd';default:return 'th';} }

    function updateClock(){
      const now=new Date();
      clockEl.textContent=`${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
      const days=['SUN','MON','TUE','WED','THU','FRI','SAT'];
      const months=['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'];
      dateEl.textContent=`${days[now.getDay()]} ${now.getDate()}${getOrdinal(now.getDate())} ${months[now.getMonth()]} ${now.getFullYear()}`;

      const nextYear=new Date(`January 1, ${now.getFullYear()+1} 00:00:00`);
      const diff=nextYear-now;
      countdownEl.textContent=`${pad(Math.floor(diff/(1000*60*60*24)))}:${pad(Math.floor((diff/(1000*60*60))%24))}:${pad(Math.floor((diff/(1000*60))%60))}:${pad(Math.floor((diff/1000)%60))}`;

      const startOfYear=new Date(`January 1, ${now.getFullYear()} 00:00:00`);
      const yearPercentLeft=Math.floor(100-((now-startOfYear)/(nextYear-startOfYear)*100));
      const startOfMonth=new Date(now.getFullYear(), now.getMonth(),1,0,0,0);
      const nextMonth=new Date(now.getFullYear(), now.getMonth()+1,1,0,0,0);
      const monthPercentLeft=Math.floor(100-((now-startOfMonth)/(nextMonth-startOfMonth)*100));
      percentageEl.textContent=`Year: ${yearPercentLeft}% | Month: ${monthPercentLeft}%`;
    }

    updateClock();
    setInterval(updateClock,1000);

    // To-Do List logic
    let todos=[];
    const todoListEl=document.getElementById('todo-list');
    const todoDateInput=document.getElementById('todo-date');
    const todoTextInput=document.getElementById('todo-text');
    const loadingText = document.getElementById('loading-text');
    const todayStr=new Date().toISOString().split('T')[0];
    todoDateInput.value=todayStr;

    function renderTodos(){
      const selectedDate=todoDateInput.value;
      todoListEl.innerHTML='';
      todos.forEach((todo,index)=>{
        if(todo.date!==selectedDate) return;
        const div=document.createElement('div');
        div.className='todo-item';

        const leftDiv=document.createElement('div');
        leftDiv.className='todo-left';

        const checkbox=document.createElement('input');
        checkbox.type='checkbox';
        checkbox.className='todo-checkbox';
        checkbox.checked=todo.completed;
        checkbox.addEventListener('change',()=>{
          todo.completed=checkbox.checked;
          todoTextSpan.classList.toggle('completed',checkbox.checked);
          saveTodosToFirebase();
        });

        const todoTextSpan=document.createElement('span');
        todoTextSpan.className='todo-text';
        todoTextSpan.textContent=todo.text;
        if(todo.completed) todoTextSpan.classList.add('completed');
        todoTextSpan.addEventListener('click',()=>{
          todoTextSpan.classList.toggle('expanded');
        });

        leftDiv.appendChild(checkbox);
        leftDiv.appendChild(todoTextSpan);

        const deleteBtn=document.createElement('button');
        deleteBtn.className='delete-btn';
        deleteBtn.textContent='âœ•';
        deleteBtn.addEventListener('click',()=>{
          if(confirm('Are you sure you want to delete this task?')){
            todos.splice(index,1);
            renderTodos();
            saveTodosToFirebase();
          }
        });

        div.appendChild(leftDiv);
        div.appendChild(deleteBtn);
        todoListEl.appendChild(div);
      });
    }

    function addTodo(){
      const date=todoDateInput.value;
      const text=todoTextInput.value.trim();
      if(date&&text){
        todos.push({date,text,completed:false});
        renderTodos();
        saveTodosToFirebase();
        todoTextInput.value='';
      }
      return false;
    }

    function saveTodosToFirebase(){
      db.ref('todos').set(todos).catch(err=>console.error(err));
    }

    function loadTodosFromFirebase(){
      loadingText.style.display = 'block';
      db.ref('todos').get().then(snapshot=>{
        if(snapshot.exists()) todos=snapshot.val();
        renderTodos();
        loadingText.style.display = 'none';
      }).catch(err=>{console.error(err); loadingText.style.display='none';});
    }

    todoDateInput.addEventListener('change',renderTodos);
    todoTextInput.addEventListener('keypress',function(e){if(e.key==='Enter'){e.preventDefault(); addTodo();}});

    loadTodosFromFirebase();

    // Daily Journal logic
    const journalDateInput = document.getElementById('journal-date');
    const journalText = document.getElementById('journal-text');
    const todayStrJournal = new Date().toISOString().split('T')[0];
    journalDateInput.value = todayStrJournal;

    function loadJournal(){
      const dateKey = journalDateInput.value.replace(/-/g,'');
      db.ref('journal/' + dateKey).get().then(snapshot => {
        if(snapshot.exists()) journalText.value = snapshot.val();
        else journalText.value = '';
      }).catch(err=>console.error(err));
    }

    function saveJournal(){
      const dateKey = journalDateInput.value.replace(/-/g,'');
      db.ref('journal/' + dateKey).set(journalText.value).catch(err=>console.error(err));
    }

    journalDateInput.addEventListener('change',loadJournal);
    journalText.addEventListener('input',saveJournal);

    loadJournal();
  </script>
</body>
   </html>
   
